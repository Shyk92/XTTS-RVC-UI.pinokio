{
  "run": [
    {
      "method": "shell.start",
      "params": {
        "env": {
          "HF_HOME": "./huggingface",
          "ALLOW_FILE_UPLOAD": "True"
        }
      }
    },
    {
      "method": "shell.enter",
      "params": {
        "message": "{{os.platform() === 'win32' ? 'venv\\\\Scripts\\\\activate' : 'source venv/bin/activate'}}",
        "on": [
          {
            "event": null,
            "return": true
          }
        ]
      }
    },
    {
      "method": "shell.enter",
      "params": {
        "message": "{{{os.platform() === 'darwin' ? 'export PYTORCH_ENABLE_MPS_FALLBACK=1' : null}}",
        "on": [
          {
            "event": null,
            "return": true
          }
        ]
      }
    },
    {
      "method": "shell.enter",
      "params": {
        "message": "{{os.platform() === 'darwin' ? 'python XTTS-RVC-UI/app.py' : 'python XTTS-RVC-UI/app.py'}}",
        "on": [
          {
            "event": "/(http://[0-9.:]+)/",
            "return": "{{event.matches[0][1]}}"
          }
        ]
      }
    },
    {
      "method": "self.set",
      "params": {
        "session.json": {
          "url": "{{input}}"
        }
      }
    },
    {
      "method": "browser.open",
      "params": {
        "uri": "{{self.session.url}}",
        "target": "_blank"
      }
    },
    {
      "method": "process.wait"
    }
  ]
}
